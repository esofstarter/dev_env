<VirtualHost *:80>

    ServerName ${SERVER_NAME}
    ServerAlias www.${SERVER_NAME}

    DocumentRoot ${DOCUMENT_ROOT}

    ProxyPass /index.php !
    ProxyPass /api !
    ProxyPass /storage !
    ProxyPass /login !
    ProxyPass /admin !
    ProxyPass /js !
    ProxyPass /fonts !
    ProxyPass /images !
    ProxyPass /css !
    ProxyPass /log-viewer !


    ProxyPass /documents !
    ProxyPass /robots.txt !
    ProxyPassMatch "^(/sla-20(.*))$" !
    ProxyPassMatch "^(/sitemap(.*))$" !
    ProxyPassMatch "^(/password/email)$" !
    ProxyPassMatch "^(/password/laravel/reset)$" !

    ProxyPass / http://${NODE_SERVICE}:${NODE_PORT}/
    ProxyPassReverse / http://${NODE_SERVICE}:${NODE_PORT}/
    Protocols h2 h2c http/1.1

    Timeout 1000
    ProxyTimeout 1000

    <Directory ${DOCUMENT_ROOT}>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    <FilesMatch \.php$>
            SetHandler "proxy:fcgi://localhost:9000"
    </FilesMatch>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

</VirtualHost>
